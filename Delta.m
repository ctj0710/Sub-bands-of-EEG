% To extract Delta band
clc;
clear all;
close all;
s=load('brux1_edfm.mat');
x=s.val;
c1=x(1,:);
nn=2048;
c1=c1(1:nn);
f1=0.5;
f2=4;
N=4;
fs=128;
w1=2*f1/fs;
w2=2*f2/fs;
[B,A]=butter(N,[w1 w2]);
[h,c]=freqz(B,A,512,fs);
m=20*log10(abs(h));
figure(1);
plot(c,m);
xlabel('frequency');
ylabel('gain in db');
t=length(c1);
n=1:t;
a=filter(B,A,c1);
figure(2);
n1=300; n2=300;
subplot(2,1,1);
plot(n,c1);
axis([1 2048 -n1 n2]);
subplot(2,1,2);
plot(n,a);
axis([1 2048 -n1 n2]);
